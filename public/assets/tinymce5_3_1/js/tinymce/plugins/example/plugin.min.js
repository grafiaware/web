tinymce.PluginManager.add('example', function(editor, url) {
    var menu1 = '<!DOCTYPE html>' +
              '<html>' +
              '<head><link rel="stylesheet" type="text/css" href="public/web/semantic/dist/semantic.min.css?>">'+
              '</head>' + //<link rel="stylesheet" type="text/css" href="public/web/grafia/css/zkouska_less.css?>" />
              '<body>'+
                  '<div class="column mceNonEditable">'+
                    '<div class="ui segment">'+
                        '<a href=" index.php ">'+
                            '<div class="ui two column grid centered">'+
                                '<div class="column">'+
                                    '<div class="ui header mceEditable" style="background-color: lightcyan">Nadpis</div>'+
                                    '<div class="content mceEditable" style="background-color: lightpink">Krátký popis</div>'+
                                '</div>'+
                                '<div class="column middle aligned centered">'+
                                    '<p class="mceEditable">Zde bude obrázek</p>'+
                                '</div>'+
                            '</div>'+
                        '</a>'+
                    '</div>'+
                   '</div>'+
              '</body>' +
              '</html>';
    var menu2 = '<!DOCTYPE html>' +
              '<html>' +
              '<head><link rel="stylesheet" type="text/css" href="public/web/semantic/dist/semantic.min.css?>">'+
              '</head>' + //<link rel="stylesheet" type="text/css" href="public/web/grafia/css/zkouska_less.css?>" />
              '<body>'+
                  '<div class="column mceNonEditable">'+
                    '<div class="ui segment">'+
                        '<a href=" index.php ">'+
                            '<div class="content">'+
                                '<p>Zde bude obrázek</p>'+
                            '</div>'+
                            '<div class="content">'+
                                '<h2 style="background-color: lightcyan">Nadpis</h2>'+
                                '<p style="background-color: lightpink">Krátký popis</p>'+
                            '</div>'+
                        '</a>'+
                    '</div>'+
                   '</div>'+
              '</body>' +
              '</html>';
    var openDialog = function () {
        return editor.windowManager.open({
            title: 'Šablona menu',
            body: {
                type: 'tabpanel',
                tabs: [
                    { 
                        name: 'sablona',
                        title: 'Výběr šablony',
                        items: [
                            {
                                type: 'selectbox',
                                name: 'vyberSablonu',
                                label: 'Vyberte vzhled položky',
                                items: [
                                    {value: 'menu1',text: 'Možnost 1'},
                                    {value: 'menu2',text: 'Možnost 2'},
                                ],
                            },
                            {
                                type: 'iframe',
                                name: 'iframe',
                                label: 'Náhled šablony',
                                sandboxed: false
                            }

                        ]
                    },
                    {
                        name: 'vlozitData',
                        title: 'Vložení dat',
                        items: [
                            {
                                type: 'selectbox',
                                name: 'prirazeniUrl',
                                label: 'Vyberte název položky menu',
                                items: [
                                    {value: 'web/v1/page/item/5defdc487897c', text: 'Vzdělávání'},
                                    {value: 'web/v1/page/item/5defdc48a5e54', text: 'Vydavatelství'},
                                ]
                            },
                            {
                                type: 'input',
                                name: 'header',
                                label: 'Nadpis',
                            },
                            {
                                type: 'input',
                                name: 'text',
                                label: 'Krátký popis'
                            },
                            {
                                type: 'urlinput', 
                                name: 'odkaz', 
                                filetype: 'file', 
                                label: 'Url', 
                                disabled: true 
                            },
                            {
                                type: 'dropzone',
                                name: 'image',
                                label: 'Vložte obrázek',
                            }
                        ],
                    },
                ]
            },
            buttons: [
                {
                  type: 'cancel',
                  text: 'Zavřít',
                },
                {
                  type: 'submit',
                  text: 'Vložit',
                  primary: true
                }
            ],
            initialData: {
                vyberSablonu: 'menu1',
                iframe:  menu1
            },
            onChange: (dialogApi, details) => {
                if (dialogApi.getData().vyberSablonu === 'menu1'){
                    dialogApi.setData({
                        iframe: menu1
                     });
                }
                if (dialogApi.getData().vyberSablonu === 'menu2'){
                    dialogApi.setData({
                        iframe: menu2
                  });
                }
            },
            
            onSubmit: function (api) { 
                var data = api.getData();
                // Insert content when the window form is submitted
                if (data.vyberSablonu === 'menu1'){
                    editor.insertContent( 
                        '<div class="column mceNonEditable" data-pokus="pokus">'+
                            '<div class="ui segment">'+
                                '<a href="' + data.prirazeniUrl + '">'+
                                    '<div class="ui two column grid stackable centered">'+
                                        '<div class="column">'+
                                            '<div class="ui header mceEditable" style="background-color: lightcyan">' + data.header + '</div>'+
                                            '<div class="content mceEditable" style="background-color: lightpink">' + data.text + '</div>'+
                                        '</div>'+
                                        '<div class="column middle aligned centered">'+
                                            '<p class="mceEditable">' + data.image + '</p>'+
                                        '</div>'+
                                    '</div>'+
                                '</a>'+
                            '</div>'+
                        '</div>'
                    );
                }
                
                if (data.vyberSablonu === 'menu2'){
                    editor.insertContent( 
                        '<div class="column mceNonEditable">'+
                            '<div class="ui segment">'+
                                '<a href="' + data.prirazeniUrl + '">'+
                                    '<div class="content">'+
                                        '<p>' + data.image +'</p>'+
                                    '</div>'+
                                    '<div class="content">'+
                                        '<h2 style="background-color: lightcyan">' + data.header + '</h2>'+
                                        '<p style="background-color: lightpink">' + data.text + '</p>'+
                                    '</div>'+
                                '</a>'+
                            '</div>'+
                        '</div>'
                    );
                }
                api.close();
                
            }
        });
    };
    // Add a button that opens a window
    editor.ui.registry.addButton('example', {
        text: 'Sablona',
        onAction: function () {
            // Open window
            openDialog();
        }
    });
    return {
        getMetadata: function () {
            return  {
                name: "Example plugin",
                url: "http://exampleplugindocsurl.com"
            };
        }
    };
});
